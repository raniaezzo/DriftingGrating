filterparam = const.stimRadius_ypix;
imsize = filterparam*2+1;

[x, y] = meshgrid(-imsize/2+0.5:imsize/2-0.5, -imsize/2+0.5:imsize/2-0.5);
[~, r] = cart2pol(x,y);

alpha = zeros(imsize,imsize);

inner_radius = filterparam - const.stimCosEdge_pix; % 384 - 177 (or 44)
outer_radius = filterparam;


figure
cosX = linspace(-pi, 0, 1000);
cosY = (cos(cosX)+1)/2;
plot(cosY)

test = r(r < outer_radius);
maxRmax(test)

for ii = 1:imsize
    for jj = 1:imsize
        if r(ii,jj) < inner_radius
            alpha(ii,jj) = 0;
        elseif r(ii,jj) < outer_radius
            alpha(ii,jj) = (1-cosd(r(ii,jj)-inner_radius))/2
            %cosY(round(r(ii,jj)-inner_radius));
            %(1-cosd(r(ii,jj)-inner_radius))/2;
        else
            alpha(ii,jj) = 1;
        end
    end
end

plot(alpha(307,:))